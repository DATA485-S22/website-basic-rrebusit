<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Rica Rebusit" />


<title>Classification</title>

<script src="site_libs/header-attrs-2.13/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/darkly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Rica Rebusit</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Blog Posts
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="blog.html">First Blog</a>
    </li>
    <li>
      <a href="tidymodel.html">Tidy Model Tutorial</a>
    </li>
    <li>
      <a href="classification.html">Classification</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/rrebusit">
    <span class="fa fa-github"></span>
     
    Github
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Classification</h1>
<h4 class="author">Rica Rebusit</h4>
<h4 class="date">5/11/2022</h4>

</div>


<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>In this blog post, I will be using classification models in the tidy models framework. I will be predicting stroke using this data set from kaggle: <a href="https://www.kaggle.com/datasets/fedesoriano/stroke-prediction-dataset">Click Me</a></p>
</div>
<div id="variables" class="section level2">
<h2>Variables</h2>
<p>id: The patient’s identity number</p>
<p>gender: The gender the patient identifies as. ‘Male’, ‘Female’, or ‘Other’</p>
<p>age: Age of the patient in years</p>
<p>hypertension: If patient has hypertension or high blood pressure. 0 for no and 1 for yes</p>
<p>heart_disease: If patient has heart disease. 0 for no and 1 for yes</p>
<p>ever_married: If the patient has been married. Yes for yes and no for no</p>
<p>work_type: The type of employment the patient is in. ‘Private’, ‘Self-employed’, ‘Government job’, ‘Never_worked’, or people who do not have a job which is ‘chilren’</p>
<p>Residence_type: The type of area where the patient lives. ‘Urban’ or ‘Rural’</p>
<p>average_glucose_level: Average glucose level of the patient. Measures the level of sugar in a patient’s blood and tests for diabetes. The normal average glucose varies by age.</p>
<p>bmi: Body Mass Index of patient</p>
<p>smoking_status: If the patient smokes, never smokes, smoked before, or unknown</p>
<p>stroke: If the patient had a stroke. 0 for no and 1 for yes</p>
</div>
<div id="cleaning-up" class="section level2">
<h2>Cleaning Up</h2>
<pre class="r"><code>stroke &lt;- read.csv(&quot;~/Downloads/healthcare-dataset-stroke-data.csv&quot;)
summary(stroke)</code></pre>
<pre><code>##        id           gender               age         hypertension    
##  Min.   :   67   Length:5110        Min.   : 0.08   Min.   :0.00000  
##  1st Qu.:17741   Class :character   1st Qu.:25.00   1st Qu.:0.00000  
##  Median :36932   Mode  :character   Median :45.00   Median :0.00000  
##  Mean   :36518                      Mean   :43.23   Mean   :0.09746  
##  3rd Qu.:54682                      3rd Qu.:61.00   3rd Qu.:0.00000  
##  Max.   :72940                      Max.   :82.00   Max.   :1.00000  
##  heart_disease     ever_married        work_type         Residence_type    
##  Min.   :0.00000   Length:5110        Length:5110        Length:5110       
##  1st Qu.:0.00000   Class :character   Class :character   Class :character  
##  Median :0.00000   Mode  :character   Mode  :character   Mode  :character  
##  Mean   :0.05401                                                           
##  3rd Qu.:0.00000                                                           
##  Max.   :1.00000                                                           
##  avg_glucose_level     bmi            smoking_status         stroke       
##  Min.   : 55.12    Length:5110        Length:5110        Min.   :0.00000  
##  1st Qu.: 77.25    Class :character   Class :character   1st Qu.:0.00000  
##  Median : 91.89    Mode  :character   Mode  :character   Median :0.00000  
##  Mean   :106.15                                          Mean   :0.04873  
##  3rd Qu.:114.09                                          3rd Qu.:0.00000  
##  Max.   :271.74                                          Max.   :1.00000</code></pre>
<pre class="r"><code>str(stroke)</code></pre>
<pre><code>## &#39;data.frame&#39;:    5110 obs. of  12 variables:
##  $ id               : int  9046 51676 31112 60182 1665 56669 53882 10434 27419 60491 ...
##  $ gender           : chr  &quot;Male&quot; &quot;Female&quot; &quot;Male&quot; &quot;Female&quot; ...
##  $ age              : num  67 61 80 49 79 81 74 69 59 78 ...
##  $ hypertension     : int  0 0 0 0 1 0 1 0 0 0 ...
##  $ heart_disease    : int  1 0 1 0 0 0 1 0 0 0 ...
##  $ ever_married     : chr  &quot;Yes&quot; &quot;Yes&quot; &quot;Yes&quot; &quot;Yes&quot; ...
##  $ work_type        : chr  &quot;Private&quot; &quot;Self-employed&quot; &quot;Private&quot; &quot;Private&quot; ...
##  $ Residence_type   : chr  &quot;Urban&quot; &quot;Rural&quot; &quot;Rural&quot; &quot;Urban&quot; ...
##  $ avg_glucose_level: num  229 202 106 171 174 ...
##  $ bmi              : chr  &quot;36.6&quot; &quot;N/A&quot; &quot;32.5&quot; &quot;34.4&quot; ...
##  $ smoking_status   : chr  &quot;formerly smoked&quot; &quot;never smoked&quot; &quot;never smoked&quot; &quot;smokes&quot; ...
##  $ stroke           : int  1 1 1 1 1 1 1 1 1 1 ...</code></pre>
<pre class="r"><code>head(stroke)</code></pre>
<pre><code>##      id gender age hypertension heart_disease ever_married     work_type
## 1  9046   Male  67            0             1          Yes       Private
## 2 51676 Female  61            0             0          Yes Self-employed
## 3 31112   Male  80            0             1          Yes       Private
## 4 60182 Female  49            0             0          Yes       Private
## 5  1665 Female  79            1             0          Yes Self-employed
## 6 56669   Male  81            0             0          Yes       Private
##   Residence_type avg_glucose_level  bmi  smoking_status stroke
## 1          Urban            228.69 36.6 formerly smoked      1
## 2          Rural            202.21  N/A    never smoked      1
## 3          Rural            105.92 32.5    never smoked      1
## 4          Urban            171.23 34.4          smokes      1
## 5          Rural            174.12   24    never smoked      1
## 6          Urban            186.21   29 formerly smoked      1</code></pre>
<pre class="r"><code>stroke$stroke &lt;- as.factor(stroke$stroke)
stroke$gender &lt;- as.factor(stroke$gender)
stroke$hypertension &lt;- as.factor(stroke$hypertension)
stroke$heart_disease &lt;- as.factor(stroke$heart_disease)
stroke$ever_married &lt;- as.factor(stroke$ever_married)
stroke$work_type &lt;- as.factor(stroke$work_type)
stroke$Residence_type &lt;- as.factor(stroke$Residence_type)
stroke$smoking_status &lt;- as.factor(stroke$smoking_status)
str(stroke)</code></pre>
<pre><code>## &#39;data.frame&#39;:    5110 obs. of  12 variables:
##  $ id               : int  9046 51676 31112 60182 1665 56669 53882 10434 27419 60491 ...
##  $ gender           : Factor w/ 3 levels &quot;Female&quot;,&quot;Male&quot;,..: 2 1 2 1 1 2 2 1 1 1 ...
##  $ age              : num  67 61 80 49 79 81 74 69 59 78 ...
##  $ hypertension     : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 1 1 1 1 2 1 2 1 1 1 ...
##  $ heart_disease    : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 2 1 2 1 1 1 2 1 1 1 ...
##  $ ever_married     : Factor w/ 2 levels &quot;No&quot;,&quot;Yes&quot;: 2 2 2 2 2 2 2 1 2 2 ...
##  $ work_type        : Factor w/ 5 levels &quot;children&quot;,&quot;Govt_job&quot;,..: 4 5 4 4 5 4 4 4 4 4 ...
##  $ Residence_type   : Factor w/ 2 levels &quot;Rural&quot;,&quot;Urban&quot;: 2 1 1 2 1 2 1 2 1 2 ...
##  $ avg_glucose_level: num  229 202 106 171 174 ...
##  $ bmi              : chr  &quot;36.6&quot; &quot;N/A&quot; &quot;32.5&quot; &quot;34.4&quot; ...
##  $ smoking_status   : Factor w/ 4 levels &quot;formerly smoked&quot;,..: 1 2 2 3 2 1 2 2 4 4 ...
##  $ stroke           : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 2 2 2 2 2 2 2 2 2 2 ...</code></pre>
<pre class="r"><code>str(stroke$bmi)</code></pre>
<pre><code>##  chr [1:5110] &quot;36.6&quot; &quot;N/A&quot; &quot;32.5&quot; &quot;34.4&quot; &quot;24&quot; &quot;29&quot; &quot;27.4&quot; &quot;22.8&quot; &quot;N/A&quot; ...</code></pre>
<pre class="r"><code>stroke$bmi &lt;- as.numeric(stroke$bmi)</code></pre>
<pre><code>## Warning: NAs introduced by coercion</code></pre>
<pre class="r"><code>stroke$bmi[is.na(stroke$bmi)] &lt;- mean(stroke$bmi,na.rm=TRUE)</code></pre>
<pre class="r"><code>stroke &lt;- select(stroke, -c(&quot;id&quot;))
head(stroke)</code></pre>
<pre><code>##   gender age hypertension heart_disease ever_married     work_type
## 1   Male  67            0             1          Yes       Private
## 2 Female  61            0             0          Yes Self-employed
## 3   Male  80            0             1          Yes       Private
## 4 Female  49            0             0          Yes       Private
## 5 Female  79            1             0          Yes Self-employed
## 6   Male  81            0             0          Yes       Private
##   Residence_type avg_glucose_level      bmi  smoking_status stroke
## 1          Urban            228.69 36.60000 formerly smoked      1
## 2          Rural            202.21 28.89324    never smoked      1
## 3          Rural            105.92 32.50000    never smoked      1
## 4          Urban            171.23 34.40000          smokes      1
## 5          Rural            174.12 24.00000    never smoked      1
## 6          Urban            186.21 29.00000 formerly smoked      1</code></pre>
</div>
<div id="quick-exploratory-data-analysis" class="section level2">
<h2>Quick Exploratory Data Analysis</h2>
<pre class="r"><code>ggplot(stroke, aes(stroke, fill=stroke)) + geom_bar()</code></pre>
<p><img src="classification_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>Seems like an imbalance in data. More people have not had a stroke than people who do</p>
<pre class="r"><code>ggplot(stroke, aes(age, avg_glucose_level, color = stroke)) + geom_point(alpha = 0.4) + facet_wrap(~stroke)</code></pre>
<p><img src="classification_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>People who have had strokes are mostly elderly</p>
<pre class="r"><code>ggplot(stroke, aes(bmi, fill=stroke)) + geom_histogram() </code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="classification_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</div>
<div id="classification---logistic-regression" class="section level1">
<h1>Classification - Logistic Regression</h1>
<pre class="r"><code>par.spec &lt;- logistic_reg() %&gt;%
  set_mode(&quot;classification&quot;) %&gt;%
  set_engine(&quot;glm&quot;)
lm.fit &lt;- par.spec %&gt;%
  fit(stroke ~ age + gender + hypertension + heart_disease + avg_glucose_level + bmi + smoking_status, data=stroke)
tidy(lm.fit)</code></pre>
<pre><code>## # A tibble: 11 × 5
##    term                       estimate std.error statistic  p.value
##    &lt;chr&gt;                         &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
##  1 (Intercept)                -7.52      0.540    -13.9    4.57e-44
##  2 age                         0.0697    0.00531   13.1    2.15e-39
##  3 genderMale                  0.0154    0.141      0.109  9.13e- 1
##  4 genderOther                -7.48    325.        -0.0230 9.82e- 1
##  5 hypertension1               0.394     0.164      2.40   1.64e- 2
##  6 heart_disease1              0.299     0.190      1.57   1.16e- 1
##  7 avg_glucose_level           0.00409   0.00119    3.43   6.09e- 4
##  8 bmi                         0.00163   0.0111     0.146  8.84e- 1
##  9 smoking_statusnever smoked -0.202     0.175     -1.16   2.48e- 1
## 10 smoking_statussmokes        0.113     0.214      0.530  5.96e- 1
## 11 smoking_statusUnknown      -0.0411    0.206     -0.199  8.42e- 1</code></pre>
<pre class="r"><code>ml &lt;- initial_split(stroke, prop=.75, strata=stroke)
train &lt;- ml %&gt;%
  training()
test &lt;- ml %&gt;%
  testing()
prediction &lt;- predict(lm.fit, new_data=test, type=&quot;class&quot;)
probability &lt;- predict(lm.fit, new_data=test, type=&quot;prob&quot;)
test.train &lt;- test %&gt;%
  select(stroke) %&gt;%
  bind_cols(prediction,probability)
test.train[1:5, ]</code></pre>
<pre><code>##   stroke .pred_class   .pred_0    .pred_1
## 1      1           0 0.9308617 0.06913830
## 2      1           0 0.9622415 0.03775852
## 3      1           0 0.8216716 0.17832837
## 4      1           0 0.9236410 0.07635905
## 5      1           0 0.9229082 0.07709178</code></pre>
<pre class="r"><code>conf_mat(test.train, truth= stroke, estimate= .pred_class)</code></pre>
<pre><code>##           Truth
## Prediction    0    1
##          0 1214   64
##          1    0    0</code></pre>
<pre class="r"><code>accuracy(test.train, truth= stroke, estimate= .pred_class)</code></pre>
<pre><code>## # A tibble: 1 × 3
##   .metric  .estimator .estimate
##   &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt;
## 1 accuracy binary         0.950</code></pre>
<p>Accuracy is about 95%</p>
</div>
<div id="classification---linear-discriminant-analysis-lda" class="section level1">
<h1>Classification - Linear Discriminant Analysis (LDA)</h1>
<p>Make sure to load in <strong>library(discrim)</strong></p>
<pre class="r"><code>lda &lt;- discrim_linear() %&gt;%
  set_mode(&quot;classification&quot;) %&gt;%
  set_engine(&quot;MASS&quot;)
lda.fit &lt;- lda %&gt;%
  fit(stroke ~ age + gender + hypertension + heart_disease + avg_glucose_level + bmi + smoking_status, data=stroke)
lda.fit</code></pre>
<pre><code>## parsnip model object
## 
## Call:
## lda(stroke ~ age + gender + hypertension + heart_disease + avg_glucose_level + 
##     bmi + smoking_status, data = data)
## 
## Prior probabilities of groups:
##          0          1 
## 0.95127202 0.04872798 
## 
## Group means:
##        age genderMale genderOther hypertension1 heart_disease1
## 0 41.97154  0.4128780 0.000205719     0.0888706     0.04710965
## 1 67.72819  0.4337349 0.000000000     0.2650602     0.18875502
##   avg_glucose_level      bmi smoking_statusnever smoked smoking_statussmokes
## 0          104.7955 28.82539                  0.3707056            0.1536721
## 1          132.5447 30.21779                  0.3614458            0.1686747
##   smoking_statusUnknown
## 0             0.3079613
## 1             0.1887550
## 
## Coefficients of linear discriminants:
##                                     LD1
## age                         0.037010927
## genderMale                  0.002361466
## genderOther                -0.487323572
## hypertension1               0.759676871
## heart_disease1              1.022724281
## avg_glucose_level           0.005746359
## bmi                        -0.023781349
## smoking_statusnever smoked -0.182754282
## smoking_statussmokes       -0.116287646
## smoking_statusUnknown       0.160561765</code></pre>
<pre class="r"><code>ml2 &lt;- initial_split(stroke, prop=.75, strata=stroke)
train2 &lt;- ml2 %&gt;%
  training()
test2 &lt;- ml2 %&gt;%
  testing()
prediction2 &lt;- predict(lda.fit, new_data=test2, type=&quot;class&quot;)
probability2 &lt;- predict(lda.fit, new_data=test2, type=&quot;prob&quot;)
test.train2 &lt;- test2 %&gt;%
  select(stroke) %&gt;%
  bind_cols(prediction2,probability2)
test.train[1:5, ]</code></pre>
<pre><code>##   stroke .pred_class   .pred_0    .pred_1
## 1      1           0 0.9308617 0.06913830
## 2      1           0 0.9622415 0.03775852
## 3      1           0 0.8216716 0.17832837
## 4      1           0 0.9236410 0.07635905
## 5      1           0 0.9229082 0.07709178</code></pre>
<pre class="r"><code>conf_mat(test.train2, truth= stroke, estimate= .pred_class)</code></pre>
<pre><code>##           Truth
## Prediction    0    1
##          0 1208   58
##          1    7    5</code></pre>
<pre class="r"><code>accuracy(test.train2, truth= stroke, estimate= .pred_class)</code></pre>
<pre><code>## # A tibble: 1 × 3
##   .metric  .estimator .estimate
##   &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt;
## 1 accuracy binary         0.949</code></pre>
<p>Accuracy is about 93-95%</p>
</div>
<div id="classification---quadratic-discriminant-analysis-qda" class="section level1">
<h1>Classification - Quadratic Discriminant Analysis (QDA)</h1>
<pre class="r"><code>qda &lt;- discrim_quad() %&gt;%
  set_mode(&quot;classification&quot;) %&gt;%
  set_engine(&quot;MASS&quot;)
qda.fit &lt;- qda %&gt;%
  fit(stroke ~ age + heart_disease + avg_glucose_level + bmi + hypertension + smoking_status, data=stroke)

ml3 &lt;- initial_split(stroke, prop=.75, strata=stroke)
train3 &lt;- ml3 %&gt;%
  training()
test3 &lt;- ml3 %&gt;%
  testing()
prediction3 &lt;- predict(qda.fit, new_data=test3, type=&quot;class&quot;)
probability3 &lt;- predict(qda.fit, new_data=test3, type=&quot;prob&quot;)
test.train3 &lt;- test3 %&gt;%
  select(stroke) %&gt;%
  bind_cols(prediction3,probability3)
test.train[1:5, ]</code></pre>
<pre><code>##   stroke .pred_class   .pred_0    .pred_1
## 1      1           0 0.9308617 0.06913830
## 2      1           0 0.9622415 0.03775852
## 3      1           0 0.8216716 0.17832837
## 4      1           0 0.9236410 0.07635905
## 5      1           0 0.9229082 0.07709178</code></pre>
<pre class="r"><code>conf_mat(test.train3, truth= stroke, estimate= .pred_class)</code></pre>
<pre><code>##           Truth
## Prediction    0    1
##          0 1092   45
##          1  109   32</code></pre>
<pre class="r"><code>accuracy(test.train3, truth= stroke, estimate= .pred_class)</code></pre>
<pre><code>## # A tibble: 1 × 3
##   .metric  .estimator .estimate
##   &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt;
## 1 accuracy binary         0.879</code></pre>
<p>Accuracy is lowered and is now about 87-89%</p>
</div>
<div id="classification---k-nearest-neighbors" class="section level1">
<h1>Classification - K Nearest Neighbors</h1>
<p>Make sure to load in <strong>library(kknn)</strong></p>
<pre class="r"><code>knn &lt;- nearest_neighbor(neighbors=1) %&gt;%
  set_mode(&quot;classification&quot;) %&gt;%
  set_engine(&quot;kknn&quot;) 
knn.fit &lt;- knn %&gt;%
  fit(stroke ~ age + gender + hypertension + heart_disease + avg_glucose_level + bmi + smoking_status, data=stroke)

ml4 &lt;- initial_split(stroke, prop=.75, strata=stroke)
train4 &lt;- ml4 %&gt;%
  training()
test4 &lt;- ml4 %&gt;%
  testing()
prediction4 &lt;- predict(qda.fit, new_data=test4, type=&quot;class&quot;)
probability4 &lt;- predict(qda.fit, new_data=test4, type=&quot;prob&quot;)
test.train4 &lt;- test4 %&gt;%
  select(stroke) %&gt;%
  bind_cols(prediction4,probability4)
test.train[1:5, ]</code></pre>
<pre><code>##   stroke .pred_class   .pred_0    .pred_1
## 1      1           0 0.9308617 0.06913830
## 2      1           0 0.9622415 0.03775852
## 3      1           0 0.8216716 0.17832837
## 4      1           0 0.9236410 0.07635905
## 5      1           0 0.9229082 0.07709178</code></pre>
<pre class="r"><code>conf_mat(test.train4, truth= stroke, estimate= .pred_class)</code></pre>
<pre><code>##           Truth
## Prediction    0    1
##          0 1117   41
##          1  102   18</code></pre>
<pre class="r"><code>accuracy(test.train4, truth= stroke, estimate= .pred_class)</code></pre>
<pre><code>## # A tibble: 1 × 3
##   .metric  .estimator .estimate
##   &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt;
## 1 accuracy binary         0.888</code></pre>
<p>Accuracy is about 88%</p>
</div>
<div id="conclusion" class="section level1">
<h1>Conclusion</h1>
<p>It looks like a logisitic regression or LDA makes better predictions in stroke as their accuracy are within 93-95%</p>
</div>
<div id="about" class="section level1">
<h1>About</h1>
<p>Hi there, my name is Rica Rebusit and I am an Applied Mathematics major at California State University, Chico also in the Data Science program. I am interested in machine learning in the healthcare or sports fields.</p>
<p>Here are my links to my <a href="https://data485-s22.github.io/website-basic-rrebusit/">Website</a>, <a href="https://csuchico.joinhandshake.com/stu/users/16836139">Handshake</a>, <a href="https://github.com/rrebusit">GitHub</a></p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
